# Copyright (c) 2016-present Sven Greb <development@svengreb.de>
# This source code is licensed under the MIT license found in the license file.

# CircleCI configuration.
# References:
#   1. https://circleci.com/docs/2.0
#   2. https://circleci.com/docs/2.0/circleci-images/#nodejs
#   3. https://github.com/atom/ci

machine:
  environment:
    ATOM_LINT_WITH_BUNDLED_NODE: "true"
    APM_TEST_PACKAGES: ""
    PATH: "${PATH}:${HOME}/${CIRCLE_PROJECT_REPONAME}/node_modules/.bin"
dependencies:
  pre:
    - rm -rf ./node_modules
  override:
    - curl -s -O https://raw.githubusercontent.com/atom/ci/master/build-package.sh
    - chmod u+x build-package.sh
    - npm install -g gulp-cli
    - npm install gulp
    - npm install
test:
  override:
    - gulp --harmony lint
    - ./build-package.sh
